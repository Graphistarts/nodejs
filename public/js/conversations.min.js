$(document).ready(function(){function t(t){t=t||window;var e,s,a,o=t.document,c=o.selection,n=0,i=0;if(c)"Control"!=c.type&&(e=c.createRange(),e.collapse(!0),n=e.boundingLeft,i=e.boundingTop);else if(t.getSelection&&(c=t.getSelection(),c.rangeCount&&(e=c.getRangeAt(0).cloneRange(),e.getClientRects&&(e.collapse(!0),s=e.getClientRects(),s.length>0&&(a=s[0]),n=a.left,i=a.top),0==n&&0==i))){var r=o.createElement("span");if(r.getClientRects){r.appendChild(o.createTextNode("​")),e.insertNode(r),a=r.getClientRects()[0],n=a.left,i=a.top;var l=r.parentNode;l.removeChild(r),l.normalize()}}return{x:n,y:i}}function e(t,e){var a=((new Date).getTime(),t.length),o=e.length,c={},n="",i="",r=[],l=[],d=[],h=0,u=0,g=0,p=0;if(0==a)return 0;if(0==o)return-1;a>o?(l=t,r=e):(l=e,r=t);for(var v=r.length;v>=0;v--)d[v]=[v];for(var b=l.length;b>=0;b--)d[0][b]=b;for(v=1;v<=r.length;v++){for(b=1;b<=l.length;b++)r[v-1]==l[b-1]?d[v][b]=d[v-1][b-1]:d[v][b]=Math.min(d[v-1][b-1],Math.min(d[v][b-1],d[v-1][b]))+1,v==u+1&&b==h+1&&(g=h,p=u,d[u][h]!=d[u][h+1]||d[u+1][h+1]==d[u][h+1]&&d[u+1][h+1]==d[u+1][h]?(u=v,h=b,d[u][h]>d[p][g]&&(r[h-1]=s(r[h-1]))):h+=(d[u][h]==d[u][h+1],1));d[u][h]>d[p][g]&&(l[h-1]=s(l[h-1]))}for(var m=h;m<=l.length;m++)d[r.length][m-1]<d[r.length][m]&&(l[m-1]=s(l[m-1]));for(var f=0;f<l.length;f++)i+=l[f]+" ";for(var x=0;x<r.length;x++)n+=r[x]+" ";return t.length>e.length?(c.corrWord1=i,c.corrWord2=n):(c.corrWord1=n,c.corrWord2=i),c}function s(t){return"<strong>"+t+"</strong>"}var a=$(".chat").height()-$(".chat header").height()-$(".input-comment").height();$(".chat .content-chat").height(a-110),$("body").dblclick(".you .text",function(){if(""!=window.getSelection().toString()){var e=t();$(".tools").css("top",e.y-40),$(".tools").css("left",e.x),$(".tools").addClass("show")}}),$("body").on("click",".edit",function(t){var e=$(this).parent().find("textarea"),s=$(this).parent().find(".text").height();$(this).parents(".message").find(".correction").toggleClass("show"),$(this).parents(".message").find(".actions").toggleClass("active"),$(this).parents(".message").find(".text").toggleClass("show"),$(this).parents(".message").find(".text-corr").hasClass("show")&&$(this).parents(".message").find(".display-correction").trigger("click"),e.css("height",s+"px")}),$("body").on("click",".cancel",function(t){$(this).parents(".message").find(".edit").trigger("click")}),$("body").on("click",".display-correction",function(t){$(this).parent().find(".text-corr").toggleClass("show"),$(this).parent().find(".text").toggleClass("show-error"),$(this).parent().find(".text-corr").hasClass("show")?$(this).text("Hide correction"):$(this).text("Show correction")}),$("body").on("click",function(t){$(".tools").is(t.target)||0!==$(".tools").has(t.target).length||$(".tools").removeClass("show")}),$("body").on("click",".actions .save",function(){var t=$(this).parents(".message"),s=t.find(".text").text().split(" "),a=t.find("textarea").val().split(" "),o=e(s,a);0!=o&&o!=-1&&(t.find(".display-correction").addClass("show"),t.find(".text-corr").html(o.corrWord2),t.find(".text").html(o.corrWord1)),t.find(".edit").trigger("click")}),$(".input-comment").on("keyup",function(t){if("13"==t.keyCode){var e=$(".input-message").val(),s="<div class='message clearfix'> <div class='bubble'> <p>"+e+"</p></div> </div>";$(".chat .content-chat").append(s),$(".chat .content-chat").scrollTop($(".chat .content-chat")[0].scrollHeight-80),$(".input-message").val("")}}),$(".choices .no").on("click",function(t){$(this).parents(".add-friend").replaceWith("")}),$(".choices .yes").on("click",function(t){var e=$(this).parents(".add-friend"),s=e.find("strong").html(),a=e.find("img").attr("src"),o='<li> <button> <span class="is-connected connected"></span> <img class="mini-pic" src="'+a+'" alt="profile picture of '+s+'"/> <img src="../img/flags/fr.jpg" alt="" class="country"/> <p><strong>'+s+'</strong><span class="place">France</span></p> </button> </li>';e.replaceWith(o)});var o=['<div class="you message clearfix"> <a href="/profile/"><img class="mini-pic" src="../img/users/user_profile_1.jpg" alt=""/></a> <div class="bubble"> <button class="edit"><img src="../img/correct.svg" alt="edit button"/></button> <div class="container-content"> <p class="text show">Hi, I am Katrin, how are you ? As I saw, you are a party lover ! Do you go to Tommorowland this year ?</p> <p class="text-corr"></p> <p class="correction"> <textarea>Hi, I am Katrin, how are you ? As I saw, you are a party lover ! Do you go to Tommorowland this year ?</textarea> <div class="actions"> <button cta-text="Cancel" class="cta cta2 cancel">Cancel</button> <button cta-text="Save" class="cta save">Save</button> </div> </p> </div> <button class="display-correction">Show correction</button> </div> </div> <div class="message clearfix"> <div class="bubble"> <div class="container-content"> <p class="text show">Hey Katrin, ja ich <strong>liebe</strong> party aber ich werde leider nicht da sein weil ich schon zum party von <strong>meine</strong> schwester bin :(</p> <p class="text-corr">Hey Katrin, ja ich <strong>mag</strong> party <strong>gern</strong> aber ich werde leider nicht da sein weil ich schon zum party von <strong>meiner</strong> schwester bin :(</p> </div> </div> <button class="display-correction show">Show correction</button> </div><div class="you message clearfix"> <a href="/profile/"><img class="mini-pic" src="../img/users/user_profile_1.jpg" alt=""/></a> <div class="bubble"> <button class="edit"><img src="../img/correct.svg" alt="edit button"/></button> <div class="container-content"> <p class="text show">Oh hard luck ! Otherwise what is your favorite type of song ?</p> <p class="text-corr"></p> <p class="correction"> <textarea>Oh hard luck ! Otherwise what is your favorite type of song ?</textarea> <div class="actions"> <button cta-text="Cancel" class="cta cta2 cancel">Cancel</button> <button cta-text="Save" class="cta save">Save</button> </div> </p> </div> <button class="display-correction">Show correction</button> </div> </div>','<div class="message clearfix"> <div class="bubble"> <div class="container-content"> <p class="text show">Hola como estas ? Me llamo heaj y hablo un poco español :) Puedes ayudarme porque hago un Erasmus en mio ultimo año :) ?</p> <p class="text-corr"><strong>¿</strong>Hola como estas ? Me llamo heaj y hablo un poco español :) <strong>¿</strong> Puedes ayudarme porque hago un Erasmus en mio ultimo año ? </p> </div> </div> <button class="display-correction show">Show correction</button> </div><div class="you message clearfix"> <a href="/profile/"><img class="mini-pic" src="../img/users/1.jpg" alt=""/></a> <div class="bubble"> <button class="edit"><img src="../img/correct.svg" alt="edit button"/></button> <div class="container-content"> <p class="text show">Yes for sure ! :) Where <strong>do you will</strong> go ?</p> <p class="text-corr">Yes for sure ! :) Where <strong>will you</strong> go ?</p> <p class="correction"> <textarea>Yes for sure ! :) Where will you go ?</textarea> <div class="actions"> <button cta-text="Cancel" class="cta cta2 cancel">Cancel</button> <button cta-text="Save" class="cta save">Save</button> </div> </p> </div> <button class="display-correction show">Show correction</button> </div> </div><div class="message clearfix"> <div class="bubble"> <div class="container-content"> <p class="text show">Voy a Torrevieja</p> </div> </div> </div><div class="you message clearfix"> <a href="/profile/"><img class="mini-pic" src="../img/users/1.jpg" alt=""/></a> <div class="bubble"> <button class="edit"><img src="../img/correct.svg" alt="edit button"/></button> <div class="container-content"> <p class="text show">Oh so cool ! I live in Orihuela, 20 km from there :D Maybe we can see each other to learn ?</p> <p class="text-corr"></p> <p class="correction"> <textarea>Oh so cool ! I live in Orihuela, 20 km from there :D Maybe we can see each other to learn ?</textarea> <div class="actions"> <button cta-text="Cancel" class="cta cta2 cancel">Cancel</button> <button cta-text="Save" class="cta save">Save</button> </div> </p> </div> <button class="display-correction">Show correction</button> </div> </div>','<div class="you message clearfix"> <a href="/profile/"><img class="mini-pic" src="../img/users/2.jpg" alt=""/></a> <div class="bubble"> <button class="edit"><img src="../img/correct.svg" alt="edit button"/></button> <div class="container-content"> <p class="text show">Hi, how are you ? I live in France and I want to improve my english, I saw you wanted to learn French, what about helping each other ?</p> <p class="text-corr"></p> <p class="correction"> <textarea>Hi, how are you ? I live in France and I want to improve my english, I saw you wanted to learn French, what about helping each other ?</textarea> <div class="actions"> <button cta-text="Cancel" class="cta cta2 cancel">Cancel</button> <button cta-text="Save" class="cta save">Save</button> </div> </p> </div> <button class="display-correction">Show correction</button> </div> </div><div class="message clearfix"> <div class="bubble"> <div class="container-content"> <p class="text show">Oui cela m\'intéresse beaucoup mais je ne <strong>parles</strong> pas bien <strong>le</strong> français.</p> <p class="text-corr">Oui cela m\'intéresse beaucoup mais je ne <strong>parle</strong> pas bien français.</p> </div> </div> <button class="display-correction show">Show correction</button> </div><div class="you message clearfix"> <a href="/profile/"><img class="mini-pic" src="../img/users/2.jpg" alt=""/></a> <div class="bubble"> <button class="edit"><img src="../img/correct.svg" alt="edit button"/></button> <div class="container-content"> <p class="text show">This is not very important because we are there to learn and my english is not perfect also.</p> <p class="text-corr"></p> <p class="correction"> <textarea>This is not very because we are there to learn and my english is not perfect also.</textarea> <div class="actions"> <button cta-text="Cancel" class="cta cta2 cancel">Cancel</button> <button cta-text="Save" class="cta save">Save</button> </div> </p> </div> <button class="display-correction">Show correction</button> </div> </div>'],c=["Katz18","Alvaro","Menduil"];$("body").on("click",".conversations button",function(t){$(".current").removeClass("current"),$(this).addClass("current"),$(this).removeClass("new-message"),$(".chat .content-chat").html(o[$(this).parents("li").index()]),$(".chat header h1").html(c[$(this).parents("li").index()])})});